<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.bit.hellopt.data.MealMapper">
	
	<parameterMap type="java.util.HashMap" id="hashMap"/>
	<select id="getMeal" parameterMap="hashMap" resultType="com.bit.hellopt.vo.meal.MealVO">
	select *
      from (
            select rownum as rnum, b.*
            from (
                   select meal_no, meal_name, meal_amount, meal_unit, meal_kcal, meal_protein, meal_fat, meal_carb, meal_sodium
                   from MEAL_TB 
                   <where>
                      <if test="searchtxt!=null and searchtxt!=''">
                         <choose>
                            <when test="search=='employee_id'">
                               and meal_name=#{searchtxt}
                            </when>
                         </choose>
                      </if>
                   </where>
                   <![CDATA[
                      order by meal_no
                      )b   
                   ]]>
             <where>
                <![CDATA[
                   rownum<=#{endRow}
                ]]>
             </where>
             )
          <where>
             rnum>=#{startRow}
          </where>
	</select>
	
	<select id="getCount" resultType="int" parameterMap="hashMap">
      select count(*)
      from meal_tb
      <where>
         <if test="searchtxt!=null and searchtxt!='' ">
            <choose>
               <when test="search=='meal_name'">
                  and meal_name=#{searchtxt}
               </when>
            </choose>
         </if>
      </where>
   </select>

</mapper>